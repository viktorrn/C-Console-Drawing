
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <math.h>
#include "structs.h"
#include "matrixMath.h"

#define ScreenWidth 64/8
#define ScreenHeight 32/4
#define PI 3.142f

const int BufferSize = ScreenWidth*ScreenHeight;

void setValueOfBuffer(int x, int y, char*buffer);
void drawBuffer(int w, int h, char* buffer);
void clearBuffer(int size, char*buffer);
void printVec4(Vec4*vec);
void printMatrix(Matrix4x4 *mat);


void init_camera(Camera* cam)
{
    cam->postion.x = 0.0f;
    cam->postion.y = 0.0f;
    cam->postion.z = 0.0f;

    cam->rotation.x = 0.0f;
    cam->rotation.y = 0.0f;
}


int main()
{
    char ScreenBuffer[BufferSize];
    
    //Camera cam1;
    //init_camera(&cam1);
    double far = 20;
    double near = 0.1;
    double nf = near-far;
    double fov = PI/2;
    double top = 1;
    double e = 1/(sin(fov/2)/cos(fov/2));
    double aspect = ScreenWidth/ScreenHeight;

    Matrix4x4 ppm; //perspective projection matrix
    setMatrix4x4Values(&ppm,e/aspect,0.0f,     0.0f,         0.0f,
                             0.0f,      e,      0.0f,         0.0f,
                             0.0f,    0.0f,  far+near/(nf), 2*far/(nf),
                             0.0f,    0.0f,     -1.0f,           0.0f
                        ); 

    Triangle chad = { {1,1,1}, {1,-1,1}, {1,0,1} };
    Vec4 chadB = {chad.p0.x,chad.p0.y,chad.p0.z,1};

    printVec4(&chadB);
    transformVec4(&chadB,&ppm);
    printVec4(&chadB);

    Matrix4x4 mat1; 
    setMatrix4x4Values(&mat1,2.0f,0.0f,0.0f,0.0f,
                            0.0f,1.0f,0.0f,0.0f,
                            0.0f,0.0f,2.0f,0.0f,
                            0.0f,0.0f,0.0f,1.0f); 

    Matrix4x4 mat2; 
    setMatrix4x4Values(&mat2,1.0f,0.0f,0.0f,0.0f,
                            0.0f,1.0f,0.0f,0.0f,
                            0.0f,0.0f,1.0f,0.0f,
                            0.0f,0.0f,0.0f,1.0f); 

    Matrix4x4 mat3;
    mat3 = multiplyMatricies4x4(&mat1,&mat2);
    printMatrix(&mat3);
   
    //printf("declared stuff");
   /*  clearBuffer(BufferSize,ScreenBuffer);
    setValueOfBuffer(0,0,ScreenBuffer);
    drawBuffer(ScreenWidth,ScreenHeight,ScreenBuffer);
    */

    return 0;
}

void clearBuffer(int size, char* buffer)
{
    
    for(int i = 0; i < size; i++)
    {
        buffer[i] = ' ';
    }
}

void setValueOfBuffer(int x, int y, char* buffer)
{
    buffer[y*ScreenWidth+x] = '#';
}

void drawBuffer(int w, int h, char* buffer)
{
    system("clear");
    int i = 0;
    for(int y = 0; y < h; y++)
    {
         for(int x = 0; x < w; x++)
        {
            printf("%c",buffer[i]);
            i++;
        }
        printf("\n"); 
    }
}

void printVec4(Vec4*vec)
{
    printf("vec: (%lf, %lf, %lf, %lf ) \n",vec->x,vec->y,vec->z,vec->w);
}

void printMatrix(Matrix4x4 *mat)
{
    for(int y = 0; y < 4; y++)
    {
        for(int x = 0; x < 4; x++)
        {
            printf("%lf ",mat->m[y][x]);
        }
        printf("\n");
    }
}

char doge[1000] = 
{
'*','*','*','*','*','*','*','*','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*',
'*','*','*','*','#','#','#','#',' ',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ','#','#',' ',' ','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*',
'*','*','*','*','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*',
'*','*','#','#','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*',
'#','#','#','#',' ',' ',' ',' ',' ',' ','#','#',' ',' ',' ',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','*','#','#','*','*','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','*','*','*','*','*','*','*','*','*','*','*','*','*','*',
'#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#','#','#','#','#','#','#','*','*','#','#','#','#',' ',' ',' ',' ','#','#',' ',' ','#','#',' ',' ',' ',' ','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#',
'#','#','#','#',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','#','#','*','*',
'#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','*','*','#','#',
'#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','*','*','*','*','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','*','*','*','*','*','*',
'#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','*','*','*','*','*','*','#','#','#','#',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','#','#','#','#','*','*','*','*','*','*',
'*','*','#','#','#','#',' ',' ',' ',' ',' ',' ','#','#','#','#',' ',' ',' ',' ','#','#','#','#','#','#','#','#',' ',' ',' ',' ','#','#','#','#',' ',' ',' ',' ','#','#','*','*','*','*','*','*','*','*','*','*','#','#','#','#',' ',' ',' ',' ','#','#','#','#','#','#','#','#','#','#','*','*','*','*','#','#','#','#','#','#','#','#','#','#','#','#',' ',' ','#','#','#','#','*','*','*','*','*','*','*','*',
'*','*','#','#','#','#','#','#','#','#','#','#','*','*','#','#','#','#','*','*','*','*','*','*','*','*','*','*','#','#','*','*','*','*','#','#','#','#','#','#','*','*','*','*','*','*','*','*','*','*','*','*','#','#','#','#',' ',' ',' ',' ',' ',' ','#','#','#','#',' ',' ','#','#','#','#','#','#','#','#','#','#',' ',' ','#','#','#','#','#','#',' ',' ',' ',' ','#','#','#','#','*','*','*','*','*','*',
};